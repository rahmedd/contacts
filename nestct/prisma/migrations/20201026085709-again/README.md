# Migration `20201026085709-again`

This migration has been generated by raed at 10/26/2020, 3:57:09 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."User" ADD COLUMN "hashPass" text   NOT NULL DEFAULT E'non',
ALTER COLUMN "lastName" DROP NOT NULL

CREATE TABLE "public"."Email" (
"id" SERIAL,
"email" text   NOT NULL ,
"contactId" integer   NOT NULL ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."Email" ADD FOREIGN KEY ("contactId")REFERENCES "public"."Contact"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER INDEX "public"."User.email" RENAME TO "User.email_unique"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201026085709-again
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,51 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model User {
+  id        Int           @id @default(autoincrement())
+  email     String        @unique
+  firstName String
+  lastName  String?
+  hashPass  String        @default("non")
+  contacts  UserContact[]
+}
+
+model UserContact {
+  createdAt DateTime @default(now())
+  userId    Int
+  contactId Int
+  contacts  Contact  @relation(fields: [contactId], references: [id])
+  user      User     @relation(fields: [userId], references: [id])
+
+  @@id([userId, contactId])
+}
+
+model Contact {
+  id      Int           @id @default(autoincrement())
+  name    String
+  details String?
+  number  Number[]
+  email   Email[]
+  users   UserContact[]
+}
+
+model Number {
+  id        Int     @id @default(autoincrement())
+  number    String
+  label     String?
+  contactId Int
+  contact   Contact @relation(fields: [contactId], references: [id])
+}
+
+model Email {
+  id        Int     @id @default(autoincrement())
+  email    String
+  contactId Int
+  contact   Contact @relation(fields: [contactId], references: [id])
+}
```


